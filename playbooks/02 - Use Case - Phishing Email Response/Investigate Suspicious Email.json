{
    "@context": "\/api\/3\/contexts\/Workflow",
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Suspicious Email",
    "aliasName": null,
    "tag": null,
    "description": "Investigates an alert of type \u2018Suspicious Email\u2019.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/3cb90b29-1258-415c-8f4c-967296bccb15",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/913f726b-5194-4cce-b760-cd9fb8b7950b",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Add Drive By Download Tag",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Tagging alert as Potential <span style=\"background: #ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\"><strong>DriveByDownloadAttack<\/strong><\/span>, as the analyst observed <em>\"{{vars.steps.Mark_Drive_by_Download.input.reason}}\"<\/em><\/p>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4"
                },
                "resource": {
                    "__link": {
                        "recordTags": [
                            "\/api\/3\/tags\/DriveByDownloadAttack"
                        ]
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": {
                    "drive_by_download_check_message": "Alert tagged as Potential <span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #fff; padding: 1px 7px;\"><strong>DriveByDownloadAttack<\/strong><\/span>, as the analyst observed <em>\" {{vars.steps.Mark_Drive_by_Download.input.reason}}\"<\/em>"
                }
            },
            "status": null,
            "top": "2240",
            "left": "80",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "5fd55764-5e2f-4e1e-b263-f7aae31a4c38"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for No Spoofing",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p><span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 2px 7px;\"> No Spoofing<\/span> attempt identified<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "spoof_check_message": "<p><span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 1px 7px;\"> No Spoofing<\/span> attempt identified<\/p>"
                }
            },
            "status": null,
            "top": "1110",
            "left": "218",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "ca7cb6f3-86a3-4f60-ab8e-14e56c2bc233"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for SPF Records",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "['{{vars.input.records[0]['@id']}}']",
                    "people": [],
                    "content": "<p>{% if vars.SPF_Record | length == 0 -%}SPF check <span class=\"badge badge-pill badge-danger\" style=\"background: #dbc030; color: #000000; padding: 2px 7px;\"><strong>Not Found<\/strong><\/span><\/p>\n<p>{% else -%}{% if vars.Not_Permitted_IPs_for_SPF_Fail | length != 0 -%}<\/p>\n<p>SPF check <span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #ffffff; padding: 2px 7px;\"><strong>Failed<\/strong><\/span> due to non-permitted IP(s)<\/p>\n<p>&nbsp;<\/p>\n<p><strong>{% for ip in [vars.Not_Permitted_IPs_for_SPF_Fail] -%}IP: {{ ip }}{% endfor -%}<\/strong><\/p>\n<p>{% elif vars.Not_Permitted_IPs_for_SPF_SoftFail | length != 0 -%}<\/p>\n<p>SPF check <span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #ffffff; padding: 2px 7px;\"><strong>Soft Failed<\/strong><\/span> due to non-permitted IP(s)<\/p>\n<p>&nbsp;<\/p>\n<p><strong>{% for ip in [vars.Not_Permitted_IPs_for_SPF_SoftFail] -%}IP: {{ ip }}{% endfor -%}<\/strong><\/p>\n<p>{% else -%}SPF check <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 2px 7px;\"> Passed<\/span><\/p>\n<p>{% endif -%}{% endif %}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "spf_check_message": "{% if vars.SPF_Record | length == 0 -%}SPF(Sender Policy Framework) check <span class=\"badge badge-pill badge-danger\" style=\"background: #FFFF00; color: #000000; padding: 1px 7px;\"><span style=\"background-color: #ffff00;\"> Not Found<br><\/span><\/span>{% else -%}{% if vars.Not_Permitted_IPs_for_SPF_Fail | length != 0 -%} SPF (Sender Policy Framework) check <span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #ffffff; padding: 1px 7px;\"><span style=\"background-color: #ff0000;\"> Failed <br><\/span><\/span> due to non-permitted IP(s) {% elif vars.Not_Permitted_IPs_for_SPF_SoftFail | length != 0 -%} SPF (Sender Policy Framework) check <span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #ffffff; padding: 1px 7px;\"> Soft Failed <\/span> due to non-permitted IP(s) {% else -%} SPF (Sender Policy Framework) check <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 1px 7px;\"> Passed<\/span>{% endif -%}{% endif %}"
                }
            },
            "status": null,
            "top": "840",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "53e5f453-447e-467c-99db-d0aae943972e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Suspicious keywords",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "['{{vars.input.records[0]['@id']}}']",
                    "people": [],
                    "content": "<p>{% if vars.foundList | length != 0 %}<\/p>\n<p><span style=\"background: #ba6204; color: #fff; padding: 2px 7px;\" class=\"badge badge-pill badge-danger\"><strong>Suspicious keyword found in email body<\/strong><\/span><\/p>\n<p>- Matched keywords: {{vars.foundList | join(' , ')}}<\/p>\n<p>{% else %}<\/p>\n<p>Suspicious keywords <span style=\"background: #2aba42; color: #ffffff; padding: 2px 7px;\" class=\"badge badge-pill badge-danger\">Not Found<\/span> in email body<\/p>\n<p>{% endif %}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "suspicious_keyword_check_message": "{% if vars.foundList | length != 0 %}Suspicious keyword <span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #fff; padding: 1px 7px;\"><strong>Found<\/strong><\/span> in email body{% else %}Suspicious keywords <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 1px 7px;\">Not Found<\/span> in email body{% endif %}"
                }
            },
            "status": null,
            "top": "1380",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "8d02d41b-3ef0-4a42-b50b-4a73662d9677"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Spoofing Tag",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Sender email address '{{vars.sender_email_address}}' do not match with the Return Path '{{vars.sender_return_path}}'.<\/p>\n<p>- Tagging alert as <strong><span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #fff; padding: 2px 7px;\">Spoofing<\/span><\/strong>.<\/p>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/8c142bf0-bc97-4683-85da-3076748e060a"
                },
                "resource": {
                    "__link": {
                        "recordTags": [
                            "\/api\/3\/tags\/Spoofing"
                        ]
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": {
                    "spoof_check_message": "<p>Spoofing has been <span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #ffffff; padding: 1px 7px;\">Positively<\/span> identified and acknowledged<\/p>"
                }
            },
            "status": null,
            "top": "1110",
            "left": "568",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Approval to Block Malicious Indicators",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Approval - Block Malicious Indicators",
                        "description": "{% if vars.blocked_iocs | length > 0%}\n###### **Malicious Indicators - Already Blocked:**\n{% for i in vars.blocked_iocs %}\n* {{i[0]}} - {{i[1]}}\n{%endfor%}\n{% endif %}\n###### **Malicious Indicators - Pending Block Approval:**\n{% for i in vars.unblocked_iocs %}\n* {{i[0]}} - {{i[1]}}\n{%endfor%}\n<p><span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #fff; padding: 2px 7px;\"><strong>Action Required:<\/strong><\/span>&nbsp;Please review and approve the blocking of the listed indicators.<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "emailRecipients": ""
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/ceaae747-aa0b-4d30-9caa-d10ac0c11d9e"
                        },
                        {
                            "option": "Deny",
                            "step_iri": "\/api\/3\/workflow_steps\/2a3beb27-9706-46e0-b24b-0ffe22d70436"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "2820",
            "left": "940",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "e1e73259-c176-4382-9a39-3e0730282f30"
        },
        {
            "@type": "WorkflowStep",
            "name": "Block Malicious Indicators",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Find_Related_Malicious_Indicators}}",
                    "parallel": false,
                    "condition": "{{vars.item.indicatorStatus.itemValue not in ['Blocked','Isolated']}}"
                },
                "arguments": {
                    "indicator_type": "{{vars.item.typeofindicator.itemValue}}",
                    "indicator_value": "{{vars.item.value}}",
                    "indicator_record_iri": "{{vars.item['@id']}}",
                    "indicator_block_reason": "Block initiated by playbook."
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/1a1cac48-567a-4066-b0d1-c63457226f12"
            },
            "status": null,
            "top": "3080",
            "left": "740",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "b2ee1793-72a8-4194-992f-38ea0b5371f8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check for Drive by Download",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_URL_Indicators}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "style_colors": "{\n\"Good\": \"#52c91a\",\n\"Malicious\": \"#c42323\",\n\"Suspicious\": \"#dbc030\",\n\"TBD\": \"#696969\",\n\"No Reputation Available\": \"#6a9169\"\n}",
                    "indicator_IRI": "{{vars.item['@id']}}",
                    "indicator_value": "{{vars.item.value}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/b0c53615-bcb7-4841-a3c2-864769a8b1e2"
            },
            "status": null,
            "top": "1900",
            "left": "100",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "e8c8ecfa-2a71-42f5-816d-f8af4d42a57c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check Suspicious Keywords",
            "description": null,
            "arguments": {
                "__dummy": "{%for item in vars.SuspiciousData if item in vars.emailbody %} {{vars.foundList.append(item)}} {%endfor%}"
            },
            "status": null,
            "top": "1245",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "d980f373-6b3d-475c-8827-145eb33f376a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Close Alert?",
                        "description": "Kindly close the alert for immediate resolution or continue with the investigation as needed.",
                        "inputVariables": [
                            {
                                "name": "reason",
                                "type": "string",
                                "label": "Reason",
                                "title": "Text Area",
                                "usable": false,
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "textarea",
                                "required": false,
                                "_expanded": true,
                                "mmdUpdate": false,
                                "collection": false,
                                "searchable": false,
                                "templateUrl": "app\/components\/form\/fields\/json.html",
                                "defaultValue": null,
                                "_previousName": "reason",
                                "playbookField": true,
                                "lengthConstraint": false,
                                "allowedEncryption": true,
                                "allowedGridColumn": false,
                                "jinjaExpressionView": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "emailRecipients": ""
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Close Alert",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/3d4f3e7f-70eb-458e-94b2-3efc078f574f"
                        },
                        {
                            "option": "Continue Investigation",
                            "step_iri": "\/api\/3\/workflow_steps\/73d4e395-f08b-42be-a6a0-4178c3ada227"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "3220",
            "left": "440",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "e1d8efca-7d15-47b9-b70a-f508b5f3546a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close the Alert",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Closed the alert with the following reason:<\/p>\n<ul>\n<li>{{vars.steps.Close_Alert.input.reason}}<\/li>\n<\/ul>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                },
                "resource": {
                    "__link": {
                        "recordTags": []
                    },
                    "status": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "closureNotes": "{{vars.closure_notes}}",
                    "closureReason": "{{vars.closure_reason}}",
                    "resolvedAutomatedly": true
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3400",
            "left": "620",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "3d4f3e7f-70eb-458e-94b2-3efc078f574f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "url_list": "[]",
                "emailbody": "{{vars.input.records[0].emailBody}}",
                "foundList": "[]",
                "SPF_Record": "{% set headers =  vars.input.records[0].emailHeaders | toDict %}{% if headers.header['received-spf'] -%}{{headers.header['received-spf']}}{% elif headers['received-spf'] -%}{{headers['received-spf']}}{%- endif %}",
                "blocked_iocs": "[]",
                "SuspiciousData": "['Bitcoins','bitcoin','torrent','limewire','bittottent','piratebay']",
                "unblocked_iocs": "[]",
                "sender_return_path": "{{vars.input.records[0].returnPath | regex_search('[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+')}}",
                "sender_email_address": "{{ vars.input.records[0].senderEmailAddress | regex_search('[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') }}",
                "reporter_email_address": "{% if vars.input.records[0].reporter %}{{vars.input.records[0].reporter | regex_search('[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') }}{% else %}{{ vars.input.records[0].senderEmailAddress | regex_search('[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') }}{% endif %}"
            },
            "status": null,
            "top": "165",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "4bf37e80-b16e-47ff-817c-a94817a39833"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Suspicious Email Table",
            "description": null,
            "arguments": {
                "params": {
                    "value": "<table class=\"margin-bottom-lg\">\n<tbody>\n{% if vars.input.records[0].domain %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Domain<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].domain}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].sourceIp %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Source IP<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].sourceIp}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].destinationIp %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Destination IP<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].destinationIp}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].fileHash %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">File Hash<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].fileHash}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].computerName %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Computer Name<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].computerName}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].processName %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Process<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].processName}}<\/span><\/td>\n<\/tr>\n{% endif %}\n{% if vars.input.records[0].sourceProcess %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Source Process<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].sourceProcess}}<\/span><\/td>\n<\/tr>\n{% endif %}\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Sender<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].senderEmailAddress.split('<')[-1] | replace(\">\",\"\")}}<\/span><\/td>\n<\/tr>\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Recipient<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].recipientEmailAddress}}<\/span><\/td>\n<\/tr>\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Subject<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].emailSubject}}<\/span><\/td>\n<\/tr>\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 12px;\">Return Path<\/span><\/td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 12px;\">{{vars.input.records[0].returnPath}}<\/span><\/td>\n<\/tr>\n<\/tbody>\n<\/table>"
                },
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText (Markdown)",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "2c6f9d0b-2d39-4c03-afd2-e26b59e1dafb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Find Related Malicious Indicators",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "alerts.id",
                            "value": "{{vars.input.records[0].id}}",
                            "operator": "eq",
                            "_operator": "eq"
                        },
                        {
                            "type": "object",
                            "field": "reputation",
                            "value": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                                "display": "Malicious",
                                "itemValue": "Malicious"
                            },
                            "operator": "eq"
                        }
                    ]
                },
                "module": "indicators?$limit=30",
                "step_variables": {
                    "__dummy": "{% if vars.result | length > 0 %}\n\t{% for i in vars.result %}\n  \t\t{% set in_type = i.typeofindicator.itemValue %}\n    \t{% set in_value= i.value %}\n        {% set item=[in_type,in_value] %}\n        {% if i.indicatorStatus.itemValue in ['Blocked','Isolated'] %}\n        \t{{vars.blocked_iocs.append(item)}}\n        {% else %}\n        \t{{vars.unblocked_iocs.append(item)}}\n        {% endif %}\n\t{% endfor %}\n{% endif %}",
                    "malicious_indicator_check_message": "Malicious Indicator(s) were {%if vars.steps.Find_Related_Malicious_Indicators | length == 0 %} <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 1px 7px;\">Not Found <\/span>{%else%}<span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #ffffff; padding: 1px 7px;\"> Found <\/span>{%endif%}"
                }
            },
            "status": null,
            "top": "1515",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "885cc479-725c-44cf-a6c1-084a367fd935"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Non Permitted IP",
            "description": null,
            "arguments": {
                "Not_Permitted_IPs_for_SPF_Fail": "{% for var in vars.SPF_Record if vars.SPF_Record %}{{\n    (var | regex_search('(?<=client-ip=)([\\S]*)(?=;)'))\n    if (var.startswith('fail') and var | regex_search('(?<=fail)([^,]+)(?i)'))\n}}{%endfor%}",
                "Not_Permitted_IPs_for_SPF_SoftFail": "{% for var in vars.SPF_Record if vars.SPF_Record %}{{\n    (var | regex_search('(?<=client-ip=)([\\S]*)(?=;)'))\n    if (var.startswith('softfail') and var | regex_search('(?<=softfail)([^,]+)(?i)'))\n}}{%endfor%}"
            },
            "status": null,
            "top": "705",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "3169def1-5aaf-4cb3-b290-a04d65d383c2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get URL Indicators",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "alerts.id",
                            "value": "{{vars.input.records[0].id}}",
                            "operator": "eq",
                            "_operator": "eq"
                        },
                        {
                            "type": "object",
                            "field": "typeofindicator",
                            "value": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                                "display": "URL",
                                "itemValue": "URL"
                            },
                            "operator": "eq"
                        }
                    ]
                },
                "module": "indicators?$limit=30",
                "step_variables": {
                    "append_url_list": "{% if vars.steps.Get_URL_Indicators | length > 0 %}\n  {% for i in vars.steps.Get_URL_Indicators %}\n    {{ vars.url_list.append({\"URL\": i.value, \"Reputation\": i.reputation.itemValue}) }}\n  {% endfor %}\n{% endif %}"
                }
            },
            "status": null,
            "top": "1650",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "535527eb-e9fa-436b-8f16-c587b0faaf11"
        },
        {
            "@type": "WorkflowStep",
            "name": "Has Malicious Content",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes - Block Indicators",
                        "step_iri": "\/api\/3\/workflow_steps\/3dfa9028-19fe-4c17-9d1b-0a0ff3f59808",
                        "condition": "{{ vars.steps.Find_Related_Malicious_Indicators | length > 0 }}",
                        "step_name": "Unblocked Malicious Indicators Found"
                    },
                    {
                        "option": "No - Suggest Closure",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
                        "step_name": "Close Alert"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "2700",
            "left": "480",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "56948a43-81dd-4759-9615-c709398634fe"
        },
        {
            "@type": "WorkflowStep",
            "name": "Has URL Indicators",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/e8c8ecfa-2a71-42f5-816d-f8af4d42a57c",
                        "condition": "{{ vars.steps.Get_URL_Indicators | length > 0 }}",
                        "step_name": "Check for Drive by Download"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
                        "step_name": "Mark Alerts as Phishing"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "94af8aba-0367-42de-a5f8-2b166f3e7bf0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark Alert as Phishing",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>- Alert severity updated to&nbsp;<span class=\"badge badge-pill badge-danger\" style=\"background: #FF0000; color: #ffffff; padding: 2px 7px;\"> Critical <\/span><\/p>\n<p>- Marked Alert as Phishing with below reason:<\/p>\n<ul>\n<li>{{vars.steps.Mark_Alerts_as_Phishing.input.reason}}<\/li>\n<\/ul>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                },
                "resource": {
                    "__link": {
                        "recordTags": [
                            "\/api\/3\/tags\/Phishing"
                        ]
                    },
                    "emailClassification": "\/api\/3\/picklists\/a1e5c01d-f703-4fa4-a5c4-b3a22f7591ab"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": {
                    "closure_notes": "{{vars.steps.Mark_Alerts_as_Phishing.input.reason}}",
                    "closure_reason": "{{\"Closure Reason\" | picklist(\"Resolved\", \"@id\")}}"
                }
            },
            "status": null,
            "top": "2420",
            "left": "660",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "03d5f6ff-7c1d-4db4-95ef-72e07b9be5ea"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark Alerts as Phishing",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Mark Alert as Phishing?",
                        "description": "<h6 class=\"text-underline\" style=\"margin: 0.5em 0 0.5em;\">Investigation Summary<\/h6>\n<br>\n\n* {{vars.spf_check_message}}\n* {{vars.spoof_check_message}}\n* {{vars.suspicious_keyword_check_message}}\n{% if vars.drive_by_download_check_message %}* {{vars.drive_by_download_check_message}}{%endif%}\n* {{vars.malicious_indicator_check_message}}",
                        "inputVariables": [
                            {
                                "name": "reason",
                                "type": "string",
                                "label": "Reason",
                                "title": "Rich Text (Markdown)",
                                "usable": true,
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "richtext",
                                "required": true,
                                "_expanded": true,
                                "mmdUpdate": true,
                                "collection": false,
                                "searchable": true,
                                "templateUrl": "app\/components\/form\/fields\/markdownEditor.html",
                                "defaultValue": null,
                                "_previousName": "closureNotes",
                                "playbookField": true,
                                "lengthConstraint": true,
                                "allowedEncryption": true,
                                "allowedGridColumn": true,
                                "jinjaExpressionView": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "emailRecipients": ""
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Mark as Phishing",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/03d5f6ff-7c1d-4db4-95ef-72e07b9be5ea"
                        },
                        {
                            "option": "Mark as False Positive",
                            "step_iri": "\/api\/3\/workflow_steps\/a19162b3-bc80-4010-bd2a-6fd4116e1617"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "2260",
            "left": "500",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "651a50a4-0175-4744-9e2d-ec2f344e8d71"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark Drive by Download",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Mark as Drive by Download?",
                        "description": "A **Drive-by Download** is the discreet installation of software on a user's device without consent, exploiting browser or plugin vulnerabilities when visiting a compromised website via a manipulated URL.<br>\nKindly verify whether the following URL(s) could lead to a drive-by download attack and take appropriate action accordingly.<br><br>\n<p>{%for i in vars.steps.Check_for_Drive_by_Download %}<\/p>\n<b><i>URL:<\/i><\/b> {{i.url}}<br>\n<b><i>Summary:<\/i><\/b> {{i.enrichment_summary}} <br>\n<p>{%endfor%}<\/p>",
                        "inputVariables": [
                            {
                                "name": "reason",
                                "type": "string",
                                "label": "Reason",
                                "title": "Text Area",
                                "usable": false,
                                "tooltip": "The reason for categorizing this alert as a Drive-by Download",
                                "dataType": "text",
                                "formType": "textarea",
                                "required": true,
                                "_expanded": true,
                                "mmdUpdate": false,
                                "collection": false,
                                "searchable": false,
                                "templateUrl": "app\/components\/form\/fields\/json.html",
                                "defaultValue": null,
                                "_previousName": "reason",
                                "playbookField": true,
                                "lengthConstraint": false,
                                "allowedEncryption": true,
                                "allowedGridColumn": false,
                                "jinjaExpressionView": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "emailRecipients": ""
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Mark Drive By Download",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/5fd55764-5e2f-4e1e-b263-f7aae31a4c38"
                        },
                        {
                            "option": "Do Not Mark",
                            "primary": false,
                            "step_iri": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "2020",
            "left": "100",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "b73f4874-574d-4a5b-aca5-097b44288ff1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Note for Already Blocked Indicators",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>All malicious indicators for this alert are already <span class=\"badge badge-pill badge-danger\" style=\"background: #14b341; color: #ffffff; padding: 1px 7px;\"> Blocked <\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2980",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "9e084978-240c-4963-b5f7-ca19bf1b7ddb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Note for Continue Investigation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>Requires additional investigation for the following reason:<\/p>\n<ul>\n<li>{{vars.steps.Close_Alert.input.reason}}<\/li>\n<\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3400",
            "left": "220",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "73d4e395-f08b-42be-a6a0-4178c3ada227"
        },
        {
            "@type": "WorkflowStep",
            "name": "Note for Request Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>- Request to block indicators is <span style=\"background: #14b341; color: #fff; padding: 2px 7px;\" class=\"badge badge-success\">Approved<\/span><\/p>\n<p>- Proceeding with block procedure<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2940",
            "left": "740",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "ceaae747-aa0b-4d30-9caa-d10ac0c11d9e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Note for Request Denied",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>Request to block indicators is <span style=\"background: #f0a313; color: black; padding: 2px 7px;\" class=\"badge badge-success\">Denied<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3220",
            "left": "940",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "2a3beb27-9706-46e0-b24b-0ffe22d70436"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Acknowledge Email to Sender",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Acknowledge receipt of a suspicious email having the subject \"{{vars.input.records[0].emailSubject}}\" is sent to the sender '{{vars.sender_email_address}}'.<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "to": "{{vars.reporter_email_address}}",
                    "body": "\u00a0We acknowledge the receipt of a suspicious email having the subject <i>\"{{vars.input.records[0].emailSubject}}\"<\/i>.",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Thank you for your submission",
                    "__replace": "",
                    "msgDirection": "\/api\/3\/picklists\/9f0a2594-2390-4086-9b6f-c7165c70ce27"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "cc0d45e1-897c-4b61-a3ef-5acf4e8418e4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Closure Response Email to Reporter",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Response email with the subject \"{{vars.result.subject}}\" is sent to the sender '{{vars.sender_email_address}}'.<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                },
                "resource": {
                    "to": "{{vars.reporter_email_address}}",
                    "body": "Hello,\n<br>\nWe are reaching out to you regarding your email.subject <i>\"{{vars.input.records[0].emailSubject}}\"<\/i> Based on the information and email provided, we determined that this is a <b>Not Phishing Type email<\/b>.\n<br>\nWe appreciate your diligence in being cautious, and we thank you for bringing this to our attention.",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Response to the Phishing Email",
                    "__replace": "",
                    "msgDirection": "\/api\/3\/picklists\/9f0a2594-2390-4086-9b6f-c7165c70ce27",
                    "communications": "{{vars.steps.Send_Acknowledge_Email_to_Sender['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2560",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "aedd87a3-56bb-429e-a41b-cccff99f4fac"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Suspicious Response Email to Sender",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Response email with the subject \"{{vars.result.subject}}\" is sent to the sender '{{vars.sender_email_address}}'.<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                },
                "resource": {
                    "to": "{{vars.reporter_email_address}}",
                    "body": "Hello,\n<br>\nWe are reaching out to you regarding your email.subject <i>\"{{vars.input.records[0].emailSubject}}\"<\/i> Based on the information and email provided, we determined that this is a <b>Phishing Type email<\/b> and it is <b>Suspicious<\/b>.\n<br>\nIf you see another email with the same characteristics, please forward the suspicious email to <i>infosec@example.com<\/i> and delete it from your mailbox.\n<br>\nWe appreciate your diligence in being cautious, and we thank you for bringing this to our attention.",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Response to the Phishing Email",
                    "__replace": "",
                    "msgDirection": "\/api\/3\/picklists\/9f0a2594-2390-4086-9b6f-c7165c70ce27",
                    "communications": "{{vars.steps.Send_Acknowledge_Email_to_Sender['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2560",
            "left": "660",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "761eb7dc-bfca-4523-a46c-a7b0bd29a4ed"
        },
        {
            "@type": "WorkflowStep",
            "name": "Spoofing Check",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4",
                        "condition": "{{ vars.sender_email_address != vars.sender_return_path }}",
                        "step_name": "Add Spoofing Tag"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/ca7cb6f3-86a3-4f60-ab8e-14e56c2bc233",
                        "step_name": "Add Note for No Spoofing"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "6647042f-f9d4-4b10-b6fe-716402582075"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "837198e7-51ae-4491-914b-069f99a5dfc3",
                "title": "Investigate Suspicious Email",
                "resources": [
                    "alerts"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "_promptexpanded": true,
                "triggerOnSource": true,
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/c145394b-069a-449b-a05e-67980d0f4b82",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/c145394b-069a-449b-a05e-67980d0f4b82",
                                    "display": "Suspicious Email",
                                    "itemValue": "Suspicious Email"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "status",
                                "value": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                                    "display": "Closed",
                                    "itemValue": "Closed"
                                },
                                "operator": "neq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "showToasterMessage": {
                    "visible": false,
                    "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "913f726b-5194-4cce-b760-cd9fb8b7950b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Suspicious Email Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Investigating Potential {{vars.input.records[0].type.itemValue}} reported by&nbsp; <strong>{{vars.input.records[0].reporter}}<\/strong>, with following fields of interest.<\/p>\n<p>&nbsp;<\/p>\n<p>{{vars.steps.Create_Suspicious_Email_Table.data['formatted_string']}}<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/cc0d45e1-897c-4b61-a3ef-5acf4e8418e4"
                },
                "resource": {
                    "__link": {
                        "communications": "{{vars.steps.Send_Acknowledge_Email_to_Sender['@id']}}"
                    },
                    "status": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "8c142bf0-bc97-4683-85da-3076748e060a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Unblocked Malicious Indicators Found",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/e1e73259-c176-4382-9a39-3e0730282f30",
                        "condition": "{{ vars.unblocked_iocs | length > 0 }}",
                        "step_name": "Approval to Block Malicious Indicators"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/9e084978-240c-4963-b5f7-ca19bf1b7ddb",
                        "step_name": "Note for Already Blocked Indicators"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "2820",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "3dfa9028-19fe-4c17-9d1b-0a0ff3f59808"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Severity to Low",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>- Alert severity updated to <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 2px 7px;\">Low<\/span><\/p>\n<p>- Marked Alert as false positive with reason:<\/p>\n<ul>\n<li>{{vars.steps.Mark_Alerts_as_Phishing.input.reason}}<\/li>\n<\/ul>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70"
                },
                "resource": {
                    "severity": "\/api\/3\/picklists\/58d0753f-f7e4-403b-953c-b0f521eab759",
                    "emailClassification": "\/api\/3\/picklists\/27ee2999-50cb-48af-8c8a-e399afcc3758"
                },
                "_showJson": true,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "tagsOperation": "OverwriteTags",
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "closure_notes": "{{vars.steps.Mark_Alerts_as_Phishing.input.reason}}",
                    "closure_reason": "{{\"Closure Reason\" | picklist(\"False Positive\", \"@id\")}}"
                }
            },
            "status": null,
            "top": "2420",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "a19162b3-bc80-4010-bd2a-6fd4116e1617"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Summary",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong>Drive-by Download<\/strong> attack was <span style=\"background: #2aba42; color: #ffffff; padding: 2px 7px;\" class=\"badge badge-pill badge-danger\">Not Observed<\/span> for the URLs:<\/p>\n<p>{% for i in vars.steps.Get_URL_Indicators %}<\/p>\n<ul>\n<li>{{i.value}}<\/li>\n<\/ul>\n<p>{%endfor%}<\/p>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4"
                },
                "resource": {
                    "__link": {
                        "recordTags": []
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": {
                    "drive_by_download_check_message": "Drive-by Download attack was <span class=\"badge badge-pill badge-danger\" style=\"background: #2aba42; color: #ffffff; padding: 1px 7px;\">Not Observed<\/span> for the URLs."
                }
            },
            "status": null,
            "top": "2120",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "f7248c0e-cf81-49d5-818f-c85d7324be70"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Add Drive By Download Tag -> Copy of Approval to Block Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
            "sourceStep": "\/api\/3\/workflow_steps\/5fd55764-5e2f-4e1e-b263-f7aae31a4c38",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "59aefcc5-bfe6-44b3-9303-41bf142f9e86"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for No Spoofing -> Check Suspicious Keywords",
            "targetStep": "\/api\/3\/workflow_steps\/d980f373-6b3d-475c-8827-145eb33f376a",
            "sourceStep": "\/api\/3\/workflow_steps\/ca7cb6f3-86a3-4f60-ab8e-14e56c2bc233",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "cb985861-cb38-4408-82cc-e56874c3a5da"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Request Denied -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "sourceStep": "\/api\/3\/workflow_steps\/2a3beb27-9706-46e0-b24b-0ffe22d70436",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "72b453e0-f84c-409d-bb45-93a36f5b2186"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for SPF Records -> Spoofing Check",
            "targetStep": "\/api\/3\/workflow_steps\/6647042f-f9d4-4b10-b6fe-716402582075",
            "sourceStep": "\/api\/3\/workflow_steps\/53e5f453-447e-467c-99db-d0aae943972e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "c991e4fa-8a2b-4946-a473-a20e97235883"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Suspicious keywords -> Find Related Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/885cc479-725c-44cf-a6c1-084a367fd935",
            "sourceStep": "\/api\/3\/workflow_steps\/8d02d41b-3ef0-4a42-b50b-4a73662d9677",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1b2cdc59-5ff1-4cd6-873d-982c37c73866"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Not for Request Approved -> Block Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/b2ee1793-72a8-4194-992f-38ea0b5371f8",
            "sourceStep": "\/api\/3\/workflow_steps\/ceaae747-aa0b-4d30-9caa-d10ac0c11d9e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "49bbb7e3-f2ce-4388-aabe-935e7581366c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Spoofing Tag -> Check Suspicious Keywords",
            "targetStep": "\/api\/3\/workflow_steps\/d980f373-6b3d-475c-8827-145eb33f376a",
            "sourceStep": "\/api\/3\/workflow_steps\/f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b3d6d6df-ebe5-4b41-bc74-cfa09c7c39af"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval to Block Malicious Indicators -> Request Approved",
            "targetStep": "\/api\/3\/workflow_steps\/ceaae747-aa0b-4d30-9caa-d10ac0c11d9e",
            "sourceStep": "\/api\/3\/workflow_steps\/e1e73259-c176-4382-9a39-3e0730282f30",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "5d5e2d52-0e37-4387-a9c6-d4fd8980f996"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval to Block Malicious Indicators -> Request Denied",
            "targetStep": "\/api\/3\/workflow_steps\/2a3beb27-9706-46e0-b24b-0ffe22d70436",
            "sourceStep": "\/api\/3\/workflow_steps\/e1e73259-c176-4382-9a39-3e0730282f30",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "ce3739d3-0b4c-425d-9824-8b66ca024f8d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Block Malicious Indicators -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "sourceStep": "\/api\/3\/workflow_steps\/b2ee1793-72a8-4194-992f-38ea0b5371f8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "811db907-45ff-420a-9c76-45635fda2546"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check for Drive by Download -> Mark Drive by Download",
            "targetStep": "\/api\/3\/workflow_steps\/b73f4874-574d-4a5b-aca5-097b44288ff1",
            "sourceStep": "\/api\/3\/workflow_steps\/e8c8ecfa-2a71-42f5-816d-f8af4d42a57c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1ca56900-b3f6-4255-9d62-155b4adb20ab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Suspicious Keywords -> Add Note for Suspicious keywords",
            "targetStep": "\/api\/3\/workflow_steps\/8d02d41b-3ef0-4a42-b50b-4a73662d9677",
            "sourceStep": "\/api\/3\/workflow_steps\/d980f373-6b3d-475c-8827-145eb33f376a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7baac75b-7252-4669-b1ce-426b86277dc1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Close Alert -> Continue Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/73d4e395-f08b-42be-a6a0-4178c3ada227",
            "sourceStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "label": "Continue Investigation",
            "isExecuted": false,
            "group": null,
            "uuid": "7da97578-d3d2-4bc0-b106-19a0aa813db5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Close Alert -> Copy Add Phishing Tag to Alert",
            "targetStep": "\/api\/3\/workflow_steps\/3d4f3e7f-70eb-458e-94b2-3efc078f574f",
            "sourceStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "label": "Close Alert",
            "isExecuted": false,
            "group": null,
            "uuid": "d215951e-af5f-4b7a-bb28-4a5a4b057a85"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Close Alert -> Copy of Send Response Email to Sender",
            "targetStep": "\/api\/3\/workflow_steps\/aedd87a3-56bb-429e-a41b-cccff99f4fac",
            "sourceStep": "\/api\/3\/workflow_steps\/a19162b3-bc80-4010-bd2a-6fd4116e1617",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a94f4bf8-4bef-48cc-94fc-2c5e147f1318"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Send Acknowledge Email to Sender",
            "targetStep": "\/api\/3\/workflow_steps\/cc0d45e1-897c-4b61-a3ef-5acf4e8418e4",
            "sourceStep": "\/api\/3\/workflow_steps\/4bf37e80-b16e-47ff-817c-a94817a39833",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "24760e67-cce7-4b1b-9186-63144e96f728"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Suspicious Email Table -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/8c142bf0-bc97-4683-85da-3076748e060a",
            "sourceStep": "\/api\/3\/workflow_steps\/2c6f9d0b-2d39-4c03-afd2-e26b59e1dafb",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "22097f91-f364-4fa5-92d7-b99d25a2c2fa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Find Related Malicious Indicators -> Copy  of Find Related Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/535527eb-e9fa-436b-8f16-c587b0faaf11",
            "sourceStep": "\/api\/3\/workflow_steps\/885cc479-725c-44cf-a6c1-084a367fd935",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "be0d3872-e971-4764-8358-f8eb02fe221e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Non Permitted IP -> Add Note for SPF Records",
            "targetStep": "\/api\/3\/workflow_steps\/53e5f453-447e-467c-99db-d0aae943972e",
            "sourceStep": "\/api\/3\/workflow_steps\/3169def1-5aaf-4cb3-b290-a04d65d383c2",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "5738b48b-e164-49c5-bd53-87917c1b00ea"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get URL Indicators -> Has URL Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/94af8aba-0367-42de-a5f8-2b166f3e7bf0",
            "sourceStep": "\/api\/3\/workflow_steps\/535527eb-e9fa-436b-8f16-c587b0faaf11",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a4750654-df6b-4d4c-b9b9-17dab132e75e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has Malicious Content -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "sourceStep": "\/api\/3\/workflow_steps\/56948a43-81dd-4759-9615-c709398634fe",
            "label": "No - Suggest Closure",
            "isExecuted": false,
            "group": null,
            "uuid": "c06ebaa5-f13d-4bf8-9053-7ef5ceff97ea"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has Malicious Content -> Unblocked Malicious Indicators Found",
            "targetStep": "\/api\/3\/workflow_steps\/3dfa9028-19fe-4c17-9d1b-0a0ff3f59808",
            "sourceStep": "\/api\/3\/workflow_steps\/56948a43-81dd-4759-9615-c709398634fe",
            "label": "Yes - Block Indicators",
            "isExecuted": false,
            "group": null,
            "uuid": "9e9b28b7-45b3-404f-977e-ace9fdd646a3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has URL Indicators -> Check for Drive by Download",
            "targetStep": "\/api\/3\/workflow_steps\/e8c8ecfa-2a71-42f5-816d-f8af4d42a57c",
            "sourceStep": "\/api\/3\/workflow_steps\/94af8aba-0367-42de-a5f8-2b166f3e7bf0",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "a26ca124-40ae-49a5-96e2-50caf36ede16"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has URL Indicators -> Copy of Approval to Block Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
            "sourceStep": "\/api\/3\/workflow_steps\/94af8aba-0367-42de-a5f8-2b166f3e7bf0",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "ff3a2516-ad45-47b9-a4b9-cd5ddeff370b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mark Alert as Phishing -> Send Suspicious Response Email to Sender",
            "targetStep": "\/api\/3\/workflow_steps\/761eb7dc-bfca-4523-a46c-a7b0bd29a4ed",
            "sourceStep": "\/api\/3\/workflow_steps\/03d5f6ff-7c1d-4db4-95ef-72e07b9be5ea",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "05d5d45b-e0d5-4618-9e26-9e0c82eb75d5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mark Alerts as Phishing -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/a19162b3-bc80-4010-bd2a-6fd4116e1617",
            "sourceStep": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
            "label": "Mark as False Positive",
            "isExecuted": false,
            "group": null,
            "uuid": "2aa73133-0cd9-4ded-9b13-947029b78809"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mark Alerts as Phishing -> Copy of Add Phishing Tag to Alert",
            "targetStep": "\/api\/3\/workflow_steps\/03d5f6ff-7c1d-4db4-95ef-72e07b9be5ea",
            "sourceStep": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
            "label": "Mark as Phishing",
            "isExecuted": false,
            "group": null,
            "uuid": "70f2d4d3-e7bf-4a88-95d5-dd907c3b27a6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "mark drive by download -> Add Drive By Download Tag",
            "targetStep": "\/api\/3\/workflow_steps\/5fd55764-5e2f-4e1e-b263-f7aae31a4c38",
            "sourceStep": "\/api\/3\/workflow_steps\/b73f4874-574d-4a5b-aca5-097b44288ff1",
            "label": "Mark Drive By Download",
            "isExecuted": false,
            "group": null,
            "uuid": "222e0285-7bf2-444a-a233-09318d33fd4a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mark Drive by Download -> Copy  of Add Drive By Download Tag",
            "targetStep": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70",
            "sourceStep": "\/api\/3\/workflow_steps\/b73f4874-574d-4a5b-aca5-097b44288ff1",
            "label": "Do Not Mark",
            "isExecuted": false,
            "group": null,
            "uuid": "d05d059d-0875-4c87-b146-cec55181f254"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Note for Already Blocked Indicators -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e1d8efca-7d15-47b9-b70a-f508b5f3546a",
            "sourceStep": "\/api\/3\/workflow_steps\/9e084978-240c-4963-b5f7-ca19bf1b7ddb",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f6380864-354c-4245-bbcc-146aeabe043c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reply to Sender -> Create Suspicious Email Table",
            "targetStep": "\/api\/3\/workflow_steps\/2c6f9d0b-2d39-4c03-afd2-e26b59e1dafb",
            "sourceStep": "\/api\/3\/workflow_steps\/cc0d45e1-897c-4b61-a3ef-5acf4e8418e4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e19aa992-6a89-45dd-922b-98c2ec3feecf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Closure Response Email to Reporter -> Has Malicious Content",
            "targetStep": "\/api\/3\/workflow_steps\/56948a43-81dd-4759-9615-c709398634fe",
            "sourceStep": "\/api\/3\/workflow_steps\/aedd87a3-56bb-429e-a41b-cccff99f4fac",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6b8fcde2-8fe3-4ca1-9a52-ab2e5f69fe3f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Suspicious Response Email to Sender -> Has Malicious Content",
            "targetStep": "\/api\/3\/workflow_steps\/56948a43-81dd-4759-9615-c709398634fe",
            "sourceStep": "\/api\/3\/workflow_steps\/761eb7dc-bfca-4523-a46c-a7b0bd29a4ed",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b082428b-370b-4666-bcff-0c7386d99fd6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Spoofing Check -> Add Note for No Spoofing",
            "targetStep": "\/api\/3\/workflow_steps\/ca7cb6f3-86a3-4f60-ab8e-14e56c2bc233",
            "sourceStep": "\/api\/3\/workflow_steps\/6647042f-f9d4-4b10-b6fe-716402582075",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "3a967f8a-bd6d-44cd-8170-4e466be690be"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Spoofing Check -> Add Spoofing Tag",
            "targetStep": "\/api\/3\/workflow_steps\/f69ddf5e-0cc9-40ca-87bb-c3ebc3b714c4",
            "sourceStep": "\/api\/3\/workflow_steps\/6647042f-f9d4-4b10-b6fe-716402582075",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "084dfaff-eac1-49cd-b394-4f0bc71b9225"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/4bf37e80-b16e-47ff-817c-a94817a39833",
            "sourceStep": "\/api\/3\/workflow_steps\/913f726b-5194-4cce-b760-cd9fb8b7950b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "8f0e44c9-3654-4a28-bfab-0263cbf7b3ad"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Suspicious Email Investigation -> Get Non Permitted IP",
            "targetStep": "\/api\/3\/workflow_steps\/3169def1-5aaf-4cb3-b290-a04d65d383c2",
            "sourceStep": "\/api\/3\/workflow_steps\/8c142bf0-bc97-4683-85da-3076748e060a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "3138782d-a80f-43f7-8014-979a7f4ff6ad"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Unblocked Malicious Indicators Found -> Approval to Block Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/e1e73259-c176-4382-9a39-3e0730282f30",
            "sourceStep": "\/api\/3\/workflow_steps\/3dfa9028-19fe-4c17-9d1b-0a0ff3f59808",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "d060cc43-c0f9-43e8-9aae-e38b846432c3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Unblocked Malicious Indicators Found -> Note for Already Blocked Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/9e084978-240c-4963-b5f7-ca19bf1b7ddb",
            "sourceStep": "\/api\/3\/workflow_steps\/3dfa9028-19fe-4c17-9d1b-0a0ff3f59808",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "191e17f2-e983-4cfd-9fb4-d9f9079d58f9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Summary -> Copy of Approval to Block Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/651a50a4-0175-4744-9e2d-ec2f344e8d71",
            "sourceStep": "\/api\/3\/workflow_steps\/f7248c0e-cf81-49d5-818f-c85d7324be70",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "3ba4e7b5-3756-437c-b78d-4975bf741156"
        }
    ],
    "groups": [],
    "priority": null,
    "uuid": "f11ec312-d45b-4d43-b16d-af809d212f2c",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "ManualAction"
    ]
}